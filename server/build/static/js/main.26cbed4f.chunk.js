(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{28:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){"use strict";a.r(t);var c,n,r,s=a(0),i=a.n(s),o=a(29),l=a.n(o),u=a(8),d=a(2),j=a(5),b=a(4),h=a.n(b),m=a(9),p=a(13),O=a.n(p);!function(e){e.channel="channel",e.category="category",e.subreddit="subreddit"}(c||(c={})),function(e){e.day="day",e.week="week",e.month="month",e.year="year",e.all="all"}(n||(n={})),function(e){e.new="new",e.top="top",e.hot="hot"}(r||(r={}));var v=function(){var e=Object(m.a)(h.a.mark((function e(t){var a,n,r,s,i,o,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===t.value||t.mode===c.subreddit){e.next=16;break}if(a=JSON.parse(localStorage.getItem("favourites")||"[]"),!((n=a.findIndex((function(e){return e.search.value===t.value&&e.search.mode===t.mode})))>=0)){e.next=8;break}(r=a)[n].rank=r[n].rank+1,e.next=15;break;case 8:return s="http://localhost:4000/api/twitch/suggestions/".concat(t.mode,"/").concat(t.value),e.next=11,O.a.get(s);case 11:i=e.sent,o=i.data,l=""!==o[0].avatar?o[0].avatar:"",r=a.concat({search:t,rank:0,avatar:l});case 15:localStorage.setItem("favourites",JSON.stringify(r));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=(a(54),a(11)),x=(a(55),a(1)),g=function(e){var t=e.src,a=e.name,c=null===t||void 0===t?void 0:t.replace("{width}","50").replace("{height}","67").replace("300x300","50x50"),n="https://static-cdn.jtvnw.net/user-default-pictures-uv/cdd517fe-def4-11e9-948e-784f43822e80-profile_image-70x70.png";return Object(x.jsxs)("div",{className:"channel-avatar-container",children:[Object(x.jsx)("img",{className:"channel-avatar",width:30,src:void 0!==c&&""!==c?c:n,alt:"".concat(a," avatar"),onError:function(e){return function(e){e.target.src=n}(e)}}),a]})},y=function(){var e=Object(s.useState)([]),t=Object(j.a)(e,2),a=t[0],c=t[1],r=Object(s.useState)(!1),i=Object(j.a)(r,2),o=i[0],l=i[1],d=Object(s.useCallback)((function(){var e=JSON.parse(localStorage.getItem("favourites")||"[]").sort((function(e,t){return e.rank<t.rank?1:-1})).slice(0,15);c(e)}),[]);Object(s.useEffect)((function(){d()}),[d]),Object(s.useEffect)((function(){var e;null===(e=document.querySelector("body"))||void 0===e||e.addEventListener("click",(function(e){var t;e.target.closest(".favourites-container")||(l(!1),null===(t=document.querySelector(".favourites-bar"))||void 0===t||t.scrollTo({top:0}))}))}),[]);var b=function(){var e;l(!1),null===(e=document.querySelector(".favourites-bar"))||void 0===e||e.scrollTo({top:0})},h=function(e){!function(e){var t=JSON.parse(localStorage.getItem("favourites")||"[]").filter((function(t){return t.search.value!==e.value||t.search.mode!==e.mode}));localStorage.setItem("favourites",JSON.stringify(t))}(e),d()};return Object(x.jsx)(x.Fragment,{children:a&&Object(x.jsx)("aside",{className:"favourites-bar ".concat(!0===o?"is-visible":""),children:Object(x.jsxs)("div",{className:"favourites-container",children:[Object(x.jsx)("h5",{className:"title-lg",children:Object(x.jsxs)(u.b,{to:"/",title:"Homepage",onClick:b,children:[Object(x.jsx)(f.d,{size:30,className:"sidebar-icon"}),Object(x.jsx)("span",{className:"title-text",children:"Homepage"})]})}),Object(x.jsxs)("button",{className:"title-lg",onClick:function(){return l(!o)},children:[Object(x.jsx)(f.c,{size:30,className:"sidebar-icon"}),Object(x.jsxs)("span",{className:"title-text",children:["Your",Object(x.jsx)("br",{})," Favourites"]})]}),a.length>0?Object(x.jsx)("ul",{className:"favourites-list",children:a.map((function(e){var t=e.search,a=e.avatar;return Object(x.jsxs)("li",{className:"favourites-item",children:[Object(x.jsx)(u.b,{to:"/".concat(t.mode,"/").concat(n.day,"/").concat(t.value),onClick:b,children:Object(x.jsx)(g,{src:a,name:t.value})}),Object(x.jsx)("button",{title:"Remove Favourite",onClick:function(){return h(t)},children:Object(x.jsx)(f.e,{size:14})})]},t.value)}))}):Object(x.jsx)("p",{className:"favourites-empty",children:"After you seach for clips your favorites will show up here"})]})})})},k=a(3),N=function(){var e=Object(m.a)(h.a.mark((function e(t,a){var n,r,s,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.mode===c.subreddit?"http://localhost:4000/api/".concat(t.mode,"/livestreamfail?timeperiod=").concat(t.timePeriod,"&sort=").concat(t.value):"http://localhost:4000/api/twitch/".concat(t.mode,"/").concat(t.value,"?timeperiod=").concat(t.timePeriod),a&&(n="".concat(n,"&after=").concat(a)),e.prev=2,e.next=5,O.a.get(n);case 5:return r=e.sent,s=r.data,a||v(t),e.abrupt("return",s);case 11:return e.prev=11,e.t0=e.catch(2),i=e.t0.response,e.abrupt("return",{error:{status:i.status,message:i.statusText}});case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,a){return e.apply(this,arguments)}}(),S=function(){var e=Object(m.a)(h.a.mark((function e(t,a){var n,r,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===c.subreddit){e.next=10;break}return n="http://localhost:4000/api/twitch/suggestions/".concat(t,"/"),a&&(n="".concat(n).concat(a)),e.next=5,O.a.get(n);case 5:return r=e.sent,s=r.data,e.abrupt("return",s);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),C=(a(62),function(e){var t=e.id,a=e.name,c=e.label,n=e.checked,r=e.value,s=e.onChange;return Object(x.jsxs)("div",{className:"radio-custom",children:[Object(x.jsx)("input",{id:t,type:"radio",name:a,checked:n,value:r,onChange:s}),Object(x.jsx)("label",{htmlFor:t,children:c})]})}),w=(a(63),a(28),a(64),function(e){var t=e.suggestions,a=e.localSearch;return Object(x.jsxs)("section",{className:"suggestions-container",children:[Object(x.jsx)("h2",{className:"title-lg",children:"Suggestions"}),t.length>0?Object(x.jsx)("ul",{className:"suggestions-list",children:a.mode&&Object(x.jsx)(x.Fragment,{children:t.map((function(e){var t=e.avatar,c=e.name;return Object(x.jsx)("li",{className:"suggestions-item",children:Object(x.jsx)(u.b,{to:"/".concat(a.mode,"/").concat(a.timePeriod,"/").concat(c),children:Object(x.jsx)(g,{src:t,name:c})})},c)}))})}):Object(x.jsx)("p",{className:"no-suggestions",children:"No suggestions found but you can still search using the button since not every user is in our database."})]})}),P=function(){var e=Object(s.useState)({mode:c.channel,value:"",timePeriod:n.day,sort:r.hot}),t=Object(j.a)(e,2),a=t[0],i=t[1],o=Object(s.useState)([]),l=Object(j.a)(o,2),u=l[0],b=l[1],p=Object(s.useState)([]),O=Object(j.a)(p,2),v=O[0],f=O[1],g=Object(s.useState)([]),y=Object(j.a)(g,2),N=y[0],P=y[1],E=Object(d.f)(),_=Object(s.useCallback)(Object(m.a)(h.a.mark((function e(){var t,n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.value.length>0&&a.mode!==c.subreddit)){e.next=7;break}return e.next=3,S(a.mode,a.value);case 3:(t=e.sent)&&b(t),e.next=25;break;case 7:if(a.mode!==c.channel){e.next=16;break}if(!(v.length>0)){e.next=12;break}b(v),e.next=16;break;case 12:return e.next=14,S(a.mode);case 14:(n=e.sent).length>0&&(b(n),f(n));case 16:if(a.mode!==c.category){e.next=25;break}if(!(N.length>0)){e.next=21;break}b(N),e.next=25;break;case 21:return e.next=23,S(a.mode);case 23:(r=e.sent).length>0&&(b(r),P(r));case 25:case"end":return e.stop()}}),e)}))),[N,v,a.mode,a.value]);Object(s.useEffect)((function(){_()}),[_]);var T=function(){var e=Object(m.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=a.value,a.mode===c.subreddit&&(n=a.sort),E.push("/".concat(a.mode,"/").concat(a.timePeriod,"/").concat(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(e){var t=e.currentTarget.value;i(Object(k.a)(Object(k.a)({},a),{},{mode:t}))},R=function(e){var t=e.currentTarget.value;i(Object(k.a)(Object(k.a)({},a),{},{timePeriod:t}))},L=function(){var e=Object(m.a)(h.a.mark((function e(t){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=t.currentTarget.value,i(Object(k.a)(Object(k.a)({},a),{},{value:c}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(e){var t=e.currentTarget.value;i(Object(k.a)(Object(k.a)({},a),{},{sort:t}))};return Object(x.jsx)("div",{className:"search-container",children:Object(x.jsxs)("form",{children:[Object(x.jsxs)("div",{className:"inputs-group",children:[Object(x.jsx)("h2",{className:"title-lg",children:"Search Clips by"}),Object(x.jsx)(C,{id:"searchType-channel",name:"search-type",label:"Channel",value:c.channel,onChange:I,checked:a.mode===c.channel}),Object(x.jsx)(C,{id:"searchType-category",name:"search-type",label:"Category/Game",value:c.category,onChange:I,checked:a.mode===c.category}),Object(x.jsx)(C,{id:"searchType-lsf",name:"search-type",label:"LiveStreamFail",value:c.subreddit,onChange:I,checked:a.mode===c.subreddit})]}),Object(x.jsxs)("div",{className:"inputs-group",children:[Object(x.jsx)("h2",{className:"title-lg",children:"Filter by Time"}),Object(x.jsx)(C,{id:"timePeriod-day",name:"timePeriod",label:"Day",value:n.day,onChange:R,checked:a.timePeriod===n.day}),Object(x.jsx)(C,{id:"timePeriod-week",name:"timePeriod",label:"Week",value:n.week,onChange:R,checked:a.timePeriod===n.week}),Object(x.jsx)(C,{id:"timePeriod-month",name:"timePeriod",label:"Month",value:n.month,onChange:R,checked:a.timePeriod===n.month}),Object(x.jsx)(C,{id:"timePeriod-year",name:"timePeriod",label:"Year",value:n.year,onChange:R,checked:a.timePeriod===n.year}),Object(x.jsx)(C,{id:"timePeriod-all",name:"timePeriod",label:"All",value:n.all,onChange:R,checked:a.timePeriod===n.all})]}),a.mode===c.subreddit&&Object(x.jsxs)("div",{className:"inputs-group",children:[Object(x.jsx)("h2",{className:"title-lg",children:"Sort by"}),Object(x.jsx)(C,{id:"sort-popular",name:"sort",label:"Popular Now",value:r.hot,onChange:F,checked:a.sort===r.hot}),Object(x.jsx)(C,{id:"sort-top",name:"sort",label:"Most Votes",value:r.top,onChange:F,checked:a.sort===r.top}),Object(x.jsx)(C,{id:"sort-new",name:"sort",label:"Most Recent",value:r.new,onChange:F,checked:a.sort===r.new})]}),a.mode!==c.subreddit&&Object(x.jsx)("input",{className:"input-main-search",type:"text",placeholder:a.mode===c.channel?"Insert the channel name":"Insert the category/game name",value:a.value,onChange:L}),Object(x.jsx)("button",{type:"submit",className:"button-generic",onClick:T,disabled:""===a.value&&a.mode!==c.subreddit,children:"Search"}),a.mode!==c.subreddit&&Object(x.jsx)(w,{suggestions:u,localSearch:a})]})})},E=function(e){return{type:"SET_CLIPS",payload:e}},_=function(e){return{type:"SET_CURRENT_CLIP",payload:e}},T=function(e){return{type:"SET_CLIP_INDEX",payload:e}},I=function(e){return{type:"UPDATE_CLIPS",payload:e}},R={clips:{data:[],pagination:{cursor:""}},currentClip:{title:"",video_url:"",comments_url:""},clipIndex:-1,currentSearch:{mode:c.channel,value:"",timePeriod:n.all,sort:r.hot}},L=Object(s.createContext)([R,function(){return R}]),F=function(e){var t=e.reducer,a=e.children,c=Object(s.useReducer)(t,R),n=Object(j.a)(c,2),r=n[0],i=n[1];return Object(x.jsx)(L.Provider,{value:[r,i],children:a})},z=a.p+"static/media/logo-reddit.569e7461.svg",A=(a(65),a(66),function(e){var t=e.visible;return Object(x.jsx)("div",{className:"loader ".concat(t),children:"Loading..."})}),D=function(){var e=Object(s.useContext)(L),t=Object(j.a)(e,2),a=t[0],c=a.clips,n=a.currentClip,r=a.clipIndex,i=a.currentSearch,o=t[1],l=Object(s.useState)("loading"),b=Object(j.a)(l,2),p=b[0],O=b[1],v=Object(s.useState)(!1),g=Object(j.a)(v,2),y=g[0],k=g[1],S=Object(s.useState)(!1),C=Object(j.a)(S,2),w=C[0],P=C[1],R=Object(d.g)();Object(s.useEffect)((function(){return O("loading"),function(){var e=Object(m.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(T(0)),o({type:"SET_CURRENT_SEARCH",payload:R}),e.next=4,N(R);case 4:"error"in(t=e.sent)?(k(!0),O("")):(o(E(t)),o(_(t.data[0])));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){o(_({title:"",video_url:"",comments_url:""})),O("loading")}}),[o,R]);var F=Object(s.useCallback)((function(e){var t=c.data,a="prev"===e?r-1:r+1;t[r].video_url===t[a].video_url?F():a<=c.data.length&&(O("loading"),o(_(t[a])),o(T(a)))}),[r,c,o]),D=Object(s.useCallback)(Object(m.a)(h.a.mark((function e(){var t,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.pagination.cursor,console.log("moreclips called"),""===t||w){e.next=9;break}return P(!0),console.log("loading clips"),e.next=7,N(i,t);case 7:"error"in(a=e.sent)?console.log(a.error):(o(I(a)),P(!1));case 9:case"end":return e.stop()}}),e)}))),[c.pagination.cursor,i,o,w]);return Object(s.useEffect)((function(){var e=c.data.length;e>0&&-1===r&&F(),e>0&&r+3>e&&D()}),[c,r,F,D]),Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("div",{className:"player-container",children:[n.video_url&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"video-controls",children:[Object(x.jsx)("h4",{className:"title-lg",children:n.title}),Object(x.jsxs)("div",{className:"right-container",children:[n.comments_url&&Object(x.jsx)("a",{className:"link-comments",href:"https://reddit.com".concat(n.comments_url),target:"_blank",rel:"noreferrer",title:"clip comments",children:Object(x.jsx)("img",{className:"",width:"25",src:z,alt:"reddit logo"})}),Object(x.jsxs)("button",{className:"btn-clips-control btn-left",onClick:function(){return F("prev")},disabled:r<=0,children:["Previous",Object(x.jsx)("i",{className:"icon-container",children:Object(x.jsx)(f.a,{size:20})})]}),Object(x.jsxs)("button",{className:"btn-clips-control btn-right",onClick:function(){return F()},disabled:c.data.length<=r+1,children:["Next",Object(x.jsx)("i",{className:"icon-container",children:Object(x.jsx)(f.a,{size:20})})]})]})]}),Object(x.jsx)("video",{className:p,src:n.video_url,autoPlay:!0,controls:!0,onEnded:function(){return F()},onLoadedData:function(){return O("")},onError:function(){return F()}})]}),y&&Object(x.jsxs)("div",{className:"error-container",children:[Object(x.jsx)(f.f,{size:48}),Object(x.jsxs)("p",{className:"error-description",children:["We couldn't find any clips for your Search.",Object(x.jsx)("br",{}),"The game/user might not exist or they might not have any clips in the selected period.",Object(x.jsx)("br",{})," Users that are currently suspended also have their clips disabled."]}),Object(x.jsx)(u.b,{to:"/",className:"button-generic",children:"New Search"})]}),Object(x.jsx)(A,{visible:p})]})})},J=(a(67),a(68),function(){return Object(x.jsx)(x.Fragment,{children:Object(x.jsx)("h1",{className:"logo-main",children:Object(x.jsxs)(u.b,{to:"/",children:["Clips ",Object(x.jsx)(f.b,{size:36})," Autoplay"]})})})}),U=function(){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(y,{}),Object(x.jsxs)("main",{className:"main-content",children:[Object(x.jsx)(J,{}),Object(x.jsxs)(d.c,{children:[Object(x.jsx)(d.a,{path:"/:mode/:timePeriod/:value?",children:Object(x.jsx)(D,{})}),Object(x.jsx)(d.a,{path:"/",children:Object(x.jsx)(P,{})})]})]})]})};l.a.render(Object(x.jsx)(i.a.StrictMode,{children:Object(x.jsx)(F,{reducer:function(e,t){switch(t.type){case"SET_CLIPS":return Object(k.a)(Object(k.a)({},e),{},{clips:Object(k.a)({},t.payload)});case"SET_CURRENT_CLIP":return Object(k.a)(Object(k.a)({},e),{},{currentClip:Object(k.a)({},t.payload)});case"SET_CLIP_INDEX":return Object(k.a)(Object(k.a)({},e),{},{clipIndex:t.payload});case"UPDATE_CLIPS":var a=e.clips.data.concat(t.payload.data);return Object(k.a)(Object(k.a)({},e),{},{clips:{data:a,pagination:{cursor:t.payload.pagination.cursor}}});case"SET_CURRENT_SEARCH":return Object(k.a)(Object(k.a)({},e),{},{currentSearch:t.payload});default:return e}},children:Object(x.jsx)(u.a,{children:Object(x.jsx)(U,{})})})}),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.26cbed4f.chunk.js.map